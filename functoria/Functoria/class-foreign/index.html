<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>foreign (functoria.Functoria.foreign)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="generator" content="doc-ock-html v1.0.0-1-g1fc9bf0"/></head><body><nav id="top"><a href="../index.html">Up</a> &mdash; <span class="package">package <a href="../../index.html">functoria</a></span></nav><header><h1><span class="keyword">Class</span> <span class="module-path">Functoria.foreign</span></h1></header><div class="doc"><p>This class can be inherited to define a <a href="../index.html#class-type-configurable">configurable</a> with an API
similar to <a href="../index.html#val-foreign">foreign</a>.</p><p>In particular, it allows dynamic packages. Here is an example:
</p><pre><code class="code">
      let main = impl @@ object
          inherit [_] foreign
              &quot;Unikernel.Main&quot; (console @-&gt; job)
          method packages = Key.(if_ is_xen)
              [package ~sublibs:[&quot;xen&quot;] &quot;vchan&quot;]
              [package ~sublibs:[&quot;lwt&quot;] &quot;vchan&quot;]
        end
    </code></pre></div><p>Signature for configurable module implementations. A
<code class="code">configurable</code> is a module implementation which contains a runtime
state which can be set either at configuration time (by the
application builder) or at runtime, using command-line
arguments.</p><div class="spec method" id="class-foreign-method-ty"><a href="#class-foreign-method-ty" class="anchor"></a><div class="def method"><code><span class="keyword">method </span>ty : <span class="type-var">'ty</span> <a href="../index.html#type-typ">typ</a></code></div><div class="doc"><p><code class="code">ty</code> is the module type of the configurable.</p></div></div><div class="spec method" id="class-foreign-method-name"><a href="#class-foreign-method-name" class="anchor"></a><div class="def method"><code><span class="keyword">method </span>name : string</code></div><div class="doc"><p><code class="code">name</code> is the unique variable name holding the runtime state of
the configurable.</p></div></div><div class="spec method" id="class-foreign-method-module_name"><a href="#class-foreign-method-module_name" class="anchor"></a><div class="def method"><code><span class="keyword">method </span>module_name : string</code></div><div class="doc"><p><code class="code">module_name</code> is the name of the module implementing the
configurable.</p></div></div><div class="spec method" id="class-foreign-method-packages"><a href="#class-foreign-method-packages" class="anchor"></a><div class="def method"><code><span class="keyword">method </span>packages : <a href="../index.html#type-package">package</a> list <a href="../index.html#type-value">value</a></code></div><div class="doc"><p><code class="code">packages</code> is the list of OPAM packages which needs to be
installed before compiling the configurable.</p></div></div><div class="spec method" id="class-foreign-method-connect"><a href="#class-foreign-method-connect" class="anchor"></a><div class="def method"><code><span class="keyword">method </span>connect : <a href="../Info/index.html#type-t">Info.t</a> <span class="keyword">&#8209;&gt;</span> string <span class="keyword">&#8209;&gt;</span> string list <span class="keyword">&#8209;&gt;</span> string</code></div><div class="doc"><p><code class="code">connect info mod args</code> is the code to execute in order to
initialize the state associated with the module <code class="code">mod</code> (usually
calling <code class="code">mod.connect</code>) with the arguments <code class="code">args</code>, in the context
of the project information <code class="code">info</code>.</p></div></div><div class="spec method" id="class-foreign-method-configure"><a href="#class-foreign-method-configure" class="anchor"></a><div class="def method"><code><span class="keyword">method </span>configure : <a href="../Info/index.html#type-t">Info.t</a> <span class="keyword">&#8209;&gt;</span> (unit, Rresult.R.msg) Rresult.result</code></div><div class="doc"><p><code class="code">configure info</code> is the code to execute in order to configure
the device. During the configuration phase, the specficied
<a href="../index.html#class-foreign-method-packages">packages</a> might not yet be there. The code might involve
generating more OCaml code, running shell scripts, etc.</p></div></div><div class="spec method" id="class-foreign-method-build"><a href="#class-foreign-method-build" class="anchor"></a><div class="def method"><code><span class="keyword">method </span>build : <a href="../Info/index.html#type-t">Info.t</a> <span class="keyword">&#8209;&gt;</span> (unit, Rresult.R.msg) Rresult.result</code></div><div class="doc"><p><code class="code">build info</code> is the code to execute in order to build
the device. During the build phase, you can rely that all
<a href="../index.html#class-foreign-method-packages">packages</a> are installed (via opam). The code might involve
generating more OCaml code (crunching directories), running
shell scripts, etc.</p></div></div><div class="spec method" id="class-foreign-method-clean"><a href="#class-foreign-method-clean" class="anchor"></a><div class="def method"><code><span class="keyword">method </span>clean : <a href="../Info/index.html#type-t">Info.t</a> <span class="keyword">&#8209;&gt;</span> (unit, Rresult.R.msg) Rresult.result</code></div><div class="doc"><p><code class="code">clean info</code> is the code to clean-up what has been generated
by <a href="../index.html#class-foreign-method-build">build</a> and <a href="../index.html#class-foreign-method-configure">configure</a>.</p></div></div><div class="spec method" id="class-foreign-method-keys"><a href="#class-foreign-method-keys" class="anchor"></a><div class="def method"><code><span class="keyword">method </span>keys : <a href="../index.html#type-key">key</a> list</code></div><div class="doc"><p><code class="code">keys</code> is the list of command-line keys to set-up the
configurable.</p></div></div><div class="spec method" id="class-foreign-method-deps"><a href="#class-foreign-method-deps" class="anchor"></a><div class="def method"><code><span class="keyword">method </span>deps : <a href="../index.html#type-abstract_impl">abstract_impl</a> list</code></div><div class="doc"><p><code class="code">deps</code> is the list of <a href="../index.html#type-abstract_impl">abstract
implementations</a> that must be initialized before calling
<a href="../index.html#class-foreign-method-connect">connect</a>.</p></div></div></body></html>